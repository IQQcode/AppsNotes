## 1. ListView理解

ListView是一种用来 **显示多个可滑动项『item』列表** 的 **ViewGroup**

![image-20210315103752972](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-befo/20210315103842.png)

显示列表：`mListView.setAdapter(adapter)`

需要使用 **Adapter** 将 **集合数据** 和每一个 **item所对应的布局** 动态适配至ListView中显示

![image-20210315104555156](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-befo/20210315104555.png)

**ListView继承关系**

**ArrayAdapter、SimpleAdapter、SimpleCursorAdapter也是继承自BaseAdapter**

![image-20210315093932792](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-befo/20210315093933.png)

**Adapter**

- BaseAdapter：**显示复杂的列表**，集合数据可以是任意类型`List<Xxx>`
- ArrayAdapter：显示文本列表，集合数据为`List<String>`或`String[]`
- SimpleAdapter：显示复杂列表，数据集合必须是`List<Map<String,Object>>`类型
- SimpleCursorAdapter：显示复杂类表，集合数据是数据库查询的结果集

![image-20210315094654545](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-befo/20210315094654.png)

<br>

### 常用属性

| 属性名称       | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| divider        | 设置 分割线 的颜色                                           |
| dividerHeight  | 设置 分割线 的高度                                           |
| scrollbars     | 设置 滚动条 的隐藏或显示                                     |
| fadeScrollbars | 设置 滚动条 的自动隐藏或显示                                 |
| entries        | 引用一个将使用在此ListView里的数组。若数组是固定的，使用此属性将比在程序中写入更为简单 |



<hr>

<br>

## 2. ArrayAdapter

构造方法

```java
ArrayAdapter(Context context, int resource, T[] objects)
    
ArrayAdapter(Context context, int resource, List<T> objects)
```

- context：上下文对象，一般为当前Activity对象
- resource：item布局文件资源id
- objects： 需要显示的数据集合(Array或List)



## 3. SimpleAdapter

```java
public SimpleAdapter(Context context, List<? extends Map<String, ?>> data,
            @LayoutRes int resource, String[] from, @IdRes int[] to)
```

- context: 上下文件对象，一般为Acivity对象
- data: 需要显示的数据集合
- resource: item布局文件标识
- from: Map对象中的key的数组，用于得到对应的value
- to: item布局文件中的子View的id的数组

![image-20210315232438831](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-befo/20210315232439.png)

<br>

## 4. **BaseAdapter

视图对象可以复用，但是缓存不能复用

为防止内存溢出OutOfMemory，ListView需要复用缓存Item视图对象

```java
// content如果没有复用
if (convertView == null) {
    // 加载item的布局, 得到View对象
    // 此处传递this是Adapter的对象
    convertView = View.inflate(MainActivity.this, R.layout.item_base_adapter, null);
}
```





<br>

-------------

## 避坑

### 解决item点击反馈

问题：当点击某一行的时候，没有背景色的变化

![image-20210316102019567](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-befo/20210316102019.png)

- 原因：行中包含了按钮，按钮抢夺了焦点

- 解决方案：夺回焦点，在**item**布局的最外层标签设置`descendantFocusability=blocksDescendants`属性